scX: Version 1.28.25
PLATFORM C(8,0),UNIQUEID C(10,0),TIMESTAMP N(10,0),CLASS M(4,0),CLASSLOC M(4,0),BASECLASS M(4,0),OBJNAME M(4,0),PARENT M(4,0),PROPERTIES M(4,0),PROTECTED M(4,0),METHODS M(4,0),OBJCODE M(4,0),OLE M(4,0),OLE2 M(4,0),RESERVED1 M(4,0),RESERVED2 M(4,0),RESERVED3 M(4,0),RESERVED4 M(4,0),RESERVED5 M(4,0),RESERVED6 M(4,0),RESERVED7 M(4,0),RESERVED8 M(4,0),USER M(4,0)
1252

[1 RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] Screen    
[START RESERVED1]
VERSION =   3.00[END RESERVED1]

[2 RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2FV0ORWRX
[CLASS] dataenvironment
[BASECLASS] dataenvironment
[OBJNAME] Dataenvironment
[START PROPERTIES]
Top = 0
Left = 0
Width = 0
Height = 0
DataSource = .NULL.
Name = "Dataenvironment"
[END PROPERTIES]
[START RESERVED2]
1[END RESERVED2]
[START RESERVED4]
1[END RESERVED4]

[3 RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2FV0ORWRY
[CLASS] form
[BASECLASS] form
[OBJNAME] Form1
[START PROPERTIES]
Top = 0
Left = 0
Height = 24
Width = 141
ShowWindow = 2
DoCreate = .T.
Caption = "Crosshairs"
Name = "Form1"
[END PROPERTIES]
[START METHODS]
PROCEDURE Destroy
cancel
ENDPROC
PROCEDURE Error
LPARAMETERS nError, cMethod, nLine
MESSAGEBOX(TRANSFORM(nerror)+CHR(13)+cmethod+CHR(13)+TRANSFORM(nline))
cancel
ENDPROC
PROCEDURE Init
*SET DEFAULT TO SYS(5)+SYS(2003)
SET HOURS TO 24
SET CENTURY on
*_vfp.Visible=.f.
this.updateandon
quit
ENDPROC
PROCEDURE updateandon
nconn=SQLSTRINGCONNECT('DRIVER={iSeries Access ODBC Driver};UID=data;PWD=data;System=192.168.30.7;DBQ=PRODUCTION TMILIB P139FILES;DFTPKGLIB=QTEMP;PKG=A/DEFAULT(IBM),2,0,0,1,0;XDYNAMIC=1;')
csql="select distinct cmodelid from bccodes where lactive = 1"
SQLEXEC(nconn,csql,'models')
SELECT models
SCAN
*!*		IF UPPER(CDOW(DATE())) = 'MONDAY'
*!*			IF TIME() >= '05:00:00' AND TIME() < '16:40:00'
*!*				ctimestring = " ((ddate = '"+DTOC(DATE()-3)+"' and ctime >= '17:00:00') or (ddate = '"+DTOC(DATE()-2)+"' and ctime < '05:00:00'))"
*!*			ELSE
*!*				ctimestring = " (ddate = '"+DTOC(DATE())+"' and ctime > '05:00:00' and ctime < '17:00:00')"
*!*			ENDIF
*!*		else
*!*			IF TIME() >= '05:00:00' AND TIME() < '16:40:00'
*!*				ctimestring = " ((ddate = '"+DTOC(DATE()-1)+"' and ctime >= '17:00:00') or (ddate = '"+DTOC(DATE())+"' and ctime < '05:00:00'))"
*!*			ELSE
*!*				ctimestring = " (ddate = '"+DTOC(DATE())+"' and ctime > '05:00:00' and ctime < '17:00:00')"
*!*			ENDIF
*!*		endif
	
	csql="Select distinct cline from bccodeinfo join bccodes on bccodeinfo.ccode = bccodes.ccode where cmodelid = '"+ALLTRIM(models.cmodelid)+"'"
	SQLEXEC(nconn,csql,'clines')
	x=RECCOUNT('clines')
	ncnt=0
	res = 0
	DO WHILE res = 0 AND ncnt < 14
		IF TIME() >= '05:00:00' AND TIME() < '16:40:00'
			ctimestring = " ((ddate = '"+DTOC(DATE()-(ncnt+2))+"' and ctime >= '17:00:00') or (ddate = '"+DTOC(DATE()-(ncnt+1))+"' and ctime < '05:00:00'))"
		ELSE
			ctimestring = " (ddate = '"+DTOC(DATE()-ncnt)+"' and ctime > '05:00:00' and ctime < '17:00:00')"
		ENDIF
		csql="Select COUNT(*)/"+TRANSFORM(x)+" as tot from prodq where cmodelid = '"+ALLTRIM(models.cmodelid)+"' and LEFT(cstationid ,4)= 'SHIP' and "+ctimestring
		SQLEXEC(nconn,csql,'counttot')
		res=counttot.tot
		ncnt = ncnt+1
	ENDDO
	
	csql="Select nshifts from andon where LEFT(cstationid,3) = '"+LEFT(models.cmodelid,3)+"'"
	SQLEXEC(nconn,csql,'nsh')
	IF nsh.nshifts = 2
		nmulti = 1
	ELSE
		nmulti = 2
	endif
	lntakt = (8*60*60)/(counttot.tot*nmulti)
	csql="Update andon set ndaily_plan = "+TRANSFORM(counttot.tot*nmulti)+" where LEFT(cstationid,3) = '"+LEFT(models.cmodelid,3)+"'"
	SQLEXEC(nconn,csql)
	csql="Update andontime set ntakt = "+TRANSFORM(lntakt)+" where LEFT(cstationid,3) = '"+LEFT(models.cmodelid,3)+"'"
	SQLEXEC(nconn,csql)
ENDSCAN
SQLDISCONNECT(nconn)
SELECT models
USE
SELECT counttot
USE
SELECT clines
use

ENDPROC
[END METHODS]
[BINSTART OBJCODE]
FEF2FF2002010000000E0800000E08000000000000000000000000000000000000000000000000DF780400000025000000E6060000000000009507000036000000290700000000000000000000FC03000300550000AD05B20054F7000010FC43
FBA2004452495645523D7B6953657269657320416363657373204F444243204472697665727D3B5549443D646174613B5057443D646174613B53797374656D3D3139322E3136382E33302E373B4442513D50524F44554354494F4E20544D494C
4942205031333946494C45533B444654504B474C49423D5154454D503B504B473D412F44454641554C542849424D292C322C302C302C312C303B5844594E414D49433D313BEA9FFDFE440054F7010010FCD9370073656C656374206469737469
6E637420636D6F64656C69642066726F6D206263636F646573207768657265206C616374697665203D2031FDFE180099FC43F70000F70100FB06006D6F64656C73EA69FDFE070046F70200FE08007EF9057905FE840054F7010010FCD9690053
656C6563742064697374696E637420636C696E652066726F6D206263636F6465696E666F206A6F696E206263636F646573206F6E206263636F6465696E666F2E63636F6465203D206263636F6465732E63636F646520776865726520636D6F64
656C6964203D202743F40200F703009B06D901002706FDFE180099FC43F70000F70100FB0600636C696E6573EA69FDFE150054F7040010FC43FB0600636C696E65734EFDFE0D0054F7050010FCF80100FDFE0D0054F7060010FCF80100FDFE1D
00182BFCF70600F8010010F00800F70500F8020E0D09FDF905CD03FE2A0025FC435EFB080030353A30303A303012F00F00435EFB080031363A34303A30300D09FDF905AE02FE7F0054F7070010FCD90C002028286464617465203D2027434324
F70500F801020603082A06D928002720616E64206374696D65203E3D202731373A30303A30302729206F7220286464617465203D202706434324F70500F801010603082A06D91A002720616E64206374696D65203C202730353A30303A303027
292906FDFE08001BF9050B03FE550054F7070010FCD90B0020286464617465203D2027434324F70500082A06D930002720616E64206374696D65203E202730353A30303A30302720616E64206374696D65203C202731373A30303A3030272906
FDFE04001EFE830054F7010010FCD9100053656C65637420434F554E54282A292F43F704005F06D9250020617320746F742066726F6D2070726F647120776865726520636D6F64656C6964203D20270643F40200F703009B06D926002720616E
64204C454654286373746174696F6E6964202C34293D2027534849502720616E642006F7070006FDFE1A0099FC43F70000F70100FB0800636F756E74746F74EA69FDFE100054F7060010FCF40800F70900FDFE110054F7050010FCF70500F801
0106FDFE04001DFE540054F7010010FCD9360053656C656374206E7368696674732066726F6D20616E646F6E207768657265204C454654286373746174696F6E69642C3329203D202743F40200F70300F801033D06D901002706FDFE150099FC
43F70000F70100FB03006E7368EA69FDFE140025FCF40A00F70B00F8010210FDF9055B04FE0D0054F70C0010FCF80101FDFE08001BF9057004FE0D0054F70C0010FCF80102FDFE04001EFE1A0054F70D0010FCF9078070F40800F70900F70C00
04030CFDFE6B0054F7010010FCD91F0055706461746520616E646F6E20736574206E6461696C795F706C616E203D2043F40800F70900F70C00045F06D91D00207768657265204C454654286373746174696F6E69642C3329203D20270643F402
00F70300F801033D06D901002706FDFE0F0099FC43F70000F70100EA69FDFE620054F7010010FCD91D0055706461746520616E646F6E74696D6520736574206E74616B74203D2043F70D005F06D91D00207768657265204C4546542863737461
74696F6E69642C3329203D20270643F40200F70300F801033D06D901002706FDFE0F0099FC43F70000F70100EA69FDFE04007FFE0C0099FC43F70000EA67FDFE070046F70200FE040051FE070046F70800FE040051FE070046F70E00FE040051
FE0300550F0005004E434F4E4E04004353514C06004D4F44454C530800434D4F44454C494401005804004E434E5403005245530B004354494D45535452494E470800434F554E54544F540300544F5403004E534807004E53484946545306004E
4D554C544906004C4E54414B540600434C494E45533A000F00AFF7000007F7010007F70200FE240099FC4343F700005F43F8020D2006F701000643F8020D200643F702005F06EA78FDFE04000BFE030055030006004E4552524F520700434D45
54484F4405004E4C494E4522000B00473928FCF80218FDFE0600470520FE0A0099F40000F70100FE040038FE03005502000400544849530B00555044415445414E444F4E070004000BFE03005500000B00757064617465616E646F6E2C000000
0000FFFF05004572726F724C0600000000FFFF0400496E6974A20600000000FFFF070044657374726F79DB0600000000FFFF3100210B41048101710081004F0881015101D100D100D101A102F1078100510541003108A1010101110141004205
51014101D1008100D1004100A101B106F1002106F1004100C1007100410071004100710041003300F100410241003200B2006100A200410032004100310000000000000000000000000000000000010000001700000093090000010000002B00
0000AF090000210A00003C0000002F0000003C0A0000A80A00004100000034000000C60A0000CC0A00004900000000290000000E08000000000000000000000000000000000000
[BINEND OBJCODE]
[START RESERVED3]
*updateandon 
[END RESERVED3]

[4 RECORD]
[PLATFORM] WINDOWS 
[UNIQUEID] _2FV0ORWRZ
[CLASS] timer
[BASECLASS] timer
[OBJNAME] Timer1
[PARENT] Form1
[START PROPERTIES]
Top = 0
Left = 0
Height = 23
Width = 23
Enabled = .F.
Interval = 43200000
Name = "Timer1"
[END PROPERTIES]
[START METHODS]
PROCEDURE Timer
thisform.updateandon

ENDPROC
[END METHODS]
[BINSTART OBJCODE]
FEF2FF200201000000B2000000B2000000000000000000000000000000000000000000000000006A38010000002500000054000000000000006900000003000000630000000000000000000000FC030003005500000D000A0099F40000F70100
FE0300550200080054484953464F524D0B00555044415445414E444F4E050054696D65722C0000000000FFFF3100A100320000000000000000000000000000000000010000001100000027000000010000000029000000B20000000000000000
0000000000000000000000
[BINEND OBJCODE]

[5 RECORD]
[PLATFORM] COMMENT 
[UNIQUEID] RESERVED  
[START PROPERTIES]
Arial, 0, 9, 5, 15, 12, 32, 3, 0
[END PROPERTIES]
[EOF]
